!function(e){var t=function(t){this.el=null,this.helpers={},this.type=t.type||"text",this.options=e.extend(!0,{},t),this.onSearch=t.onSearch||null,this.onRequest=t.onRequest||null,this.onLoad=t.onLoad||null,this.onError=t.onError||null,this.onClick=t.onClick||null,this.onAdd=t.onAdd||null,this.onNew=t.onNew||null,this.onRemove=t.onRemove||null,this.onMouseOver=t.onMouseOver||null,this.onMouseOut=t.onMouseOut||null,this.onIconClick=t.onIconClick||null,this.onScroll=t.onScroll||null,this.tmp={},delete this.options.type,delete this.options.onSearch,delete this.options.onRequest,delete this.options.onLoad,delete this.options.onError,delete this.options.onClick,delete this.options.onMouseOver,delete this.options.onMouseOut,delete this.options.onIconClick,delete this.options.onScroll,e.extend(!0,this,w2obj.field)};e.fn.w2field=function(i,n){if(0!==this.length)return 0===arguments.length?e(this).data("w2field"):("string"==typeof i&&"object"==typeof n&&(i=e.extend(!0,{},n,{type:i})),"string"==typeof i&&null==n&&(i={type:i}),i&&(i.type=String(i.type).toLowerCase()),this.each(function(n,a){var l=e(a).data("w2field");return null==l?(l=new t(i),e.extend(l,{handlers:[]}),a&&(l.el=e(a)[0]),l.init(),e(a).data("w2field",l),l):(l.clear(),"clear"!==i.type?(l=new t(i),e.extend(l,{handlers:[]}),a&&(l.el=e(a)[0]),l.init(),e(a).data("w2field",l),l):void 0)}));var a=t.prototype;return a[i]?a[i].apply(a,Array.prototype.slice.call(arguments,1)):void 0},t.prototype={custom:{},addType:function(e,t){return e=String(e).toLowerCase(),this.custom[e]=t,!0},removeType:function(e){return e=String(e).toLowerCase(),!!this.custom[e]&&(delete this.custom[e],!0)},init:function(){var t,i=this,n=this.options;if("function"!=typeof this.custom[this.type])if(-1!=["INPUT","TEXTAREA"].indexOf(this.el.tagName.toUpperCase())){switch(this.type){case"text":case"int":case"float":case"money":case"currency":case"percent":case"alphanumeric":case"bin":case"hex":t={min:null,max:null,step:1,autoFormat:!0,currencyPrefix:w2utils.settings.currencyPrefix,currencySuffix:w2utils.settings.currencySuffix,currencyPrecision:w2utils.settings.currencyPrecision,decimalSymbol:w2utils.settings.decimalSymbol,groupSymbol:w2utils.settings.groupSymbol,arrows:!1,keyboard:!0,precision:null,silent:!0,prefix:"",suffix:""},this.options=e.extend(!0,{},t,n),(n=this.options).numberRE=new RegExp("["+n.groupSymbol+"]","g"),n.moneyRE=new RegExp("["+n.currencyPrefix+n.currencySuffix+n.groupSymbol+"]","g"),n.percentRE=new RegExp("["+n.groupSymbol+"%]","g"),-1!==["text","alphanumeric","hex","bin"].indexOf(this.type)&&(n.arrows=!1,n.keyboard=!1),this.addPrefix(),this.addSuffix();break;case"color":t={prefix:"",suffix:'<div style="width: '+(parseInt(e(this.el).css("font-size"))||12)+'px">&#160;</div>',arrows:!1,keyboard:!1,advanced:null,transparent:!0},e.extend(n,t),this.addPrefix(),this.addSuffix(),""!==e(this.el).val()&&setTimeout(function(){i.change()},1);break;case"date":t={format:w2utils.settings.dateFormat,keyboard:!0,silent:!0,start:"",end:"",blocked:{},colored:{},blockWeekDays:null},this.options=e.extend(!0,{},t,n),n=this.options,null==e(this.el).attr("placeholder")&&e(this.el).attr("placeholder",n.format);break;case"time":t={format:w2utils.settings.timeFormat,keyboard:!0,silent:!0,start:"",end:"",noMinutes:!1},this.options=e.extend(!0,{},t,n),n=this.options,null==e(this.el).attr("placeholder")&&e(this.el).attr("placeholder",n.format);break;case"datetime":t={format:w2utils.settings.dateFormat+" | "+w2utils.settings.timeFormat,keyboard:!0,silent:!0,start:"",end:"",blocked:[],colored:{},placeholder:null,btn_now:!0,noMinutes:!1},this.options=e.extend(!0,{},t,n),n=this.options,null==e(this.el).attr("placeholder")&&e(this.el).attr("placeholder",n.placeholder||n.format);break;case"list":case"combo":if(t={items:[],selected:{},url:null,recId:null,recText:null,method:null,interval:350,postData:{},minLength:1,cacheMax:250,maxDropHeight:350,maxDropWidth:null,match:"begins",silent:!0,icon:null,iconStyle:"",align:"both",altRows:!0,onSearch:null,onRequest:null,onLoad:null,onError:null,onIconClick:null,renderDrop:null,compare:null,filter:!0,prefix:"",suffix:"",openOnFocus:!1,markSearch:!1},"function"==typeof n.items&&(n._items_fun=n.items),n.items=w2obj.field.prototype.normMenu.call(this,n.items),"list"===this.type){if(t.openOnFocus=!0,e(this.el).addClass("w2ui-select"),!e.isPlainObject(n.selected)&&Array.isArray(n.items))for(var a=0;a<n.items.length;a++){var l=n.items[a];if(l&&l.id===n.selected){n.selected=e.extend(!0,{},l);break}}this.watchSize()}n=e.extend({},t,n),this.options=n,e.isPlainObject(n.selected)||(n.selected={}),e(this.el).data("selected",n.selected),n.url&&(n.items=[],this.request(0)),"list"===this.type&&this.addFocus(),this.addPrefix(),this.addSuffix(),setTimeout(function(){i.refresh()},10),e(this.el).attr("autocomplete","off"),null!=n.selected.text&&e(this.el).val(n.selected.text);break;case"enum":t={items:[],selected:[],max:0,url:null,recId:null,recText:null,interval:350,method:null,postData:{},minLength:1,cacheMax:250,maxWidth:250,maxHeight:350,maxDropHeight:350,maxDropWidth:null,match:"contains",silent:!0,align:"both",altRows:!0,openOnFocus:!1,markSearch:!0,renderDrop:null,renderItem:null,compare:null,filter:!0,style:"",onSearch:null,onRequest:null,onLoad:null,onError:null,onClick:null,onAdd:null,onNew:null,onRemove:null,onMouseOver:null,onMouseOut:null,onScroll:null},"function"==typeof(n=e.extend({},t,n,{suffix:""})).items&&(n._items_fun=n.items),n.items=w2obj.field.prototype.normMenu.call(this,n.items),n.selected=w2obj.field.prototype.normMenu.call(this,n.selected),this.options=n,e.isArray(n.selected)||(n.selected=[]),e(this.el).data("selected",n.selected),n.url&&(n.items=[],this.request(0)),this.addSuffix(),this.addMulti(),this.watchSize();break;case"file":t={selected:[],max:0,maxSize:0,maxFileSize:0,maxWidth:250,maxHeight:350,maxDropHeight:350,maxDropWidth:null,readContent:!0,silent:!0,align:"both",altRows:!0,renderItem:null,style:"",onClick:null,onAdd:null,onRemove:null,onMouseOver:null,onMouseOut:null},n=e.extend({},t,n),this.options=n,e.isArray(n.selected)||(n.selected=[]),e(this.el).data("selected",n.selected),null==e(this.el).attr("placeholder")&&e(this.el).attr("placeholder",w2utils.lang("Attach files by dragging and dropping or Click to Select")),this.addMulti(),this.watchSize()}this.tmp={onChange:function(e){i.change.call(i,e)},onClick:function(e){i.click.call(i,e)},onFocus:function(e){i.focus.call(i,e)},onBlur:function(e){i.blur.call(i,e)},onKeydown:function(e){i.keyDown.call(i,e)},onKeyup:function(e){i.keyUp.call(i,e)},onKeypress:function(e){i.keyPress.call(i,e)}},e(this.el).addClass("w2field w2ui-input").data("w2field",this).on("change.w2field",this.tmp.onChange).on("click.w2field",this.tmp.onClick).on("focus.w2field",this.tmp.onFocus).on("blur.w2field",this.tmp.onBlur).on("keydown.w2field",this.tmp.onKeydown).on("keyup.w2field",this.tmp.onKeyup).on("keypress.w2field",this.tmp.onKeypress).css(w2utils.cssPrefix("box-sizing","border-box")),this.change(e.Event("change"))}else console.log("ERROR: w2field could only be applied to INPUT or TEXTAREA.",this.el);else this.custom[this.type].call(this,n)},watchSize:function(){var t=this,i=e(t.el).data("tmp")||{};i.sizeTimer=setInterval(function(){e(t.el).parents("body").length>0?t.resize():clearInterval(i.sizeTimer)},200),e(t.el).data("tmp",i)},get:function(){return-1!==["list","enum","file"].indexOf(this.type)?e(this.el).data("selected"):e(this.el).val()},set:function(t,i){if(-1!==["list","enum","file"].indexOf(this.type)){if("list"!==this.type&&i)null==e(this.el).data("selected")&&e(this.el).data("selected",[]),e(this.el).data("selected").push(t),e(this.el).change();else{var n="enum"===this.type?[t]:t;e(this.el).data("selected",n).change()}this.refresh()}else e(this.el).val(t)},setIndex:function(t,i){if(-1!==["list","enum"].indexOf(this.type)){var n=this.options.items;if(n&&n[t]){if("list"!==this.type&&i)null==e(this.el).data("selected")&&e(this.el).data("selected",[]),e(this.el).data("selected").push(n[t]),e(this.el).change();else{var a="enum"===this.type?[n[t]]:n[t];e(this.el).data("selected",a).change()}return this.refresh(),!0}}return!1},clear:function(){var t=this.options;-1!==["money","currency"].indexOf(this.type)&&e(this.el).val(e(this.el).val().replace(t.moneyRE,"")),"percent"===this.type&&e(this.el).val(e(this.el).val().replace(/%/g,"")),"list"===this.type&&e(this.el).removeClass("w2ui-select"),this.type="clear";var i=e(this.el).data("tmp");if(this.tmp){for(var n in null!=i&&(e(this.el).height("auto"),i&&i["old-padding-left"]&&e(this.el).css("padding-left",i["old-padding-left"]),i&&i["old-padding-right"]&&e(this.el).css("padding-right",i["old-padding-right"]),i&&i["old-background-color"]&&e(this.el).css("background-color",i["old-background-color"]),i&&i["old-border-color"]&&e(this.el).css("border-color",i["old-border-color"]),clearInterval(i.sizeTimer)),e(this.el).val(this.clean(e(this.el).val())).removeClass("w2field").removeData().off(".w2field"),this.helpers)e(this.helpers[n]).remove();this.helpers={}}},refresh:function(){var t=this,i=this.options,n=e(this.el).data("selected"),a=(new Date).getTime();if(-1!==["list"].indexOf(this.type)&&(e(t.el).parent().css("white-space","nowrap"),t.helpers.prefix&&t.helpers.prefix.hide(),setTimeout(function(){if(t.helpers.focus){!e.isEmptyObject(n)&&i.icon?(i.prefix='<span class="w2ui-icon '+i.icon+'"style="cursor: pointer; font-size: 14px; display: inline-block; margin-top: -1px; color: #7F98AD;'+i.iconStyle+'"></span>',t.addPrefix()):(i.prefix="",t.addPrefix());var a=t.helpers.focus.find("input");""===e(a).val()?(e(a).css("text-indent","-9999em").prev().css("opacity",0),e(t.el).val(n&&null!=n.text?w2utils.lang(n.text):"")):(e(a).css("text-indent",0).prev().css("opacity",1),e(t.el).val(""),setTimeout(function(){t.helpers.prefix&&t.helpers.prefix.hide();var n="position: absolute; opacity: 0; margin: 4px 0px 0px 2px; background-position: left !important;";i.icon?(e(a).css("margin-left","17px"),e(t.helpers.focus).find(".icon-search").attr("style",n+"width: 11px !important; opacity: 1; display: block")):(e(a).css("margin-left","0px"),e(t.helpers.focus).find(".icon-search").attr("style",n+"width: 0px !important; opacity: 0; display: none"))},1)),e(t.el).prop("readonly")||e(t.el).prop("disabled")?setTimeout(function(){e(t.helpers.prefix).css("opacity","0.6"),e(t.helpers.suffix).css("opacity","0.6")},1):setTimeout(function(){e(t.helpers.prefix).css("opacity","1"),e(t.helpers.suffix).css("opacity","1")},1)}},1)),-1!==["enum","file"].indexOf(this.type)){var l="";if(n)for(var s=0;s<n.length;s++){var o=n[s],r="";r="function"==typeof i.renderItem?i.renderItem(o,s,'<div class="w2ui-list-remove" title="'+w2utils.lang("Remove")+'" index="'+s+'">&#160;&#160;</div>'):'<div class="w2ui-list-remove" title="'+w2utils.lang("Remove")+'" index="'+s+'">&#160;&#160;</div>'+("enum"===t.type?o.text:o.name+'<span class="file-size"> - '+w2utils.formatSize(o.size)+"</span>"),l+='<li index="'+s+'" style="max-width: '+parseInt(i.maxWidth)+"px; "+(o.style?o.style:"")+'">'+r+"</li>"}var d=t.helpers.multi,u=d.find("ul");if(d.attr("style",d.attr("style")+";"+i.style),e(t.el).css("z-index","-1"),e(t.el).prop("readonly")||e(t.el).prop("disabled")?setTimeout(function(){d[0].scrollTop=0,d.addClass("w2ui-readonly").find("li").css("opacity","0.9").parent().find("li.nomouse").hide().find("input").prop("readonly",!0).parents("ul").find(".w2ui-list-remove").hide()},1):setTimeout(function(){d.removeClass("w2ui-readonly").find("li").css("opacity","1").parent().find("li.nomouse").show().find("input").prop("readonly",!1).parents("ul").find(".w2ui-list-remove").show()},1),d.find(".w2ui-enum-placeholder").remove(),u.find("li").not("li.nomouse").remove(),""!==l)u.prepend(l);else if(null!=e(t.el).attr("placeholder")&&""===d.find("input").val()){var p="padding-top: "+e(this.el).css("padding-top")+";padding-left: "+e(this.el).css("padding-left")+"; box-sizing: "+e(this.el).css("box-sizing")+"; line-height: "+e(this.el).css("line-height")+"; font-size: "+e(this.el).css("font-size")+"; font-family: "+e(this.el).css("font-family")+"; ";d.prepend('<div class="w2ui-enum-placeholder" style="'+p+'">'+e(t.el).attr("placeholder")+"</div>")}d.off("scroll.w2field").on("scroll.w2field",function(i){var n=t.trigger({phase:"before",type:"scroll",target:t.el,originalEvent:i});!0!==n.isCancelled&&t.trigger(e.extend(n,{phase:"after"}))}).find("li").data("mouse","out").on("click",function(i){var a="LI"===i.target.tagName.toUpperCase()?i.target:e(i.target).parents("LI"),l=n[e(a).attr("index")];if(!e(a).hasClass("nomouse"))if(i.stopPropagation(),e(i.target).hasClass("w2ui-list-remove")){if(e(t.el).prop("readonly")||e(t.el).prop("disabled"))return;if(!0===(s=t.trigger({phase:"before",type:"remove",target:t.el,originalEvent:i.originalEvent,item:l})).isCancelled)return;e().w2overlay(),n.splice(e(i.target).attr("index"),1),e(t.el).trigger("input").trigger("change"),e(i.target).parent().fadeOut("fast"),setTimeout(function(){t.refresh(),t.trigger(e.extend(s,{phase:"after"}))},300)}else{var s;if(!0===(s=t.trigger({phase:"before",type:"click",target:t.el,originalEvent:i.originalEvent,item:l})).isCancelled)return;if("file"===t.type){var o="";/image/i.test(l.type)&&(o='<div style="padding: 3px;">    <img src="'+(l.content?"data:"+l.type+";base64,"+l.content:"")+'" style="max-width: 300px;"         onload="var w = jQuery(this).width(); var h = jQuery(this).height();             if (w < 300 & h < 300) return;             if (w >= h && w > 300) jQuery(this).width(300);            if (w < h && h > 300) jQuery(this).height(300);"        onerror="this.style.display = \'none\'"    ></div>');var r='style="padding: 3px; text-align: right; color: #777;"',d='style="padding: 3px"';o+='<div style="padding: 8px;">    <table cellpadding="2"><tbody>    <tr><td '+r+">"+w2utils.lang("Name")+":</td><td "+d+">"+l.name+"</td></tr>    <tr><td "+r+">"+w2utils.lang("Size")+":</td><td "+d+">"+w2utils.formatSize(l.size)+"</td></tr>    <tr><td "+r+">"+w2utils.lang("Type")+":</td><td "+d+'>        <span style="width: 200px; display: block-inline; overflow: hidden; text-overflow: ellipsis; white-space: nowrap="nowrap";">'+l.type+"</span>    </td></tr>    <tr><td "+r+">"+w2utils.lang("Modified")+":</td><td "+d+">"+w2utils.date(l.modified)+"</td></tr>    </tbody></table></div>",e("#w2ui-overlay").remove(),e(a).w2overlay(o)}t.trigger(e.extend(s,{phase:"after"}))}}).on("mouseover",function(i){var a="LI"===i.target.tagName.toUpperCase()?i.target:e(i.target).parents("LI");if(!e(a).hasClass("nomouse")){if("out"===e(a).data("mouse")){var l=n[e(i.target).attr("index")],s=t.trigger({phase:"before",type:"mouseOver",target:t.el,originalEvent:i.originalEvent,item:l});if(!0===s.isCancelled)return;t.trigger(e.extend(s,{phase:"after"}))}e(a).data("mouse","over")}}).on("mouseout",function(i){var a="LI"===i.target.tagName.toUpperCase()?i.target:e(i.target).parents("LI");e(a).hasClass("nomouse")||(e(a).data("mouse","leaving"),setTimeout(function(){if("leaving"===e(a).data("mouse")){e(a).data("mouse","out");var l=n[e(i.target).attr("index")],s=t.trigger({phase:"before",type:"mouseOut",target:t.el,originalEvent:i.originalEvent,item:l});if(!0===s.isCancelled)return;t.trigger(e.extend(s,{phase:"after"}))}},0))}),e(this.el).height("auto");var c=e(d).find("> div.w2ui-multi-items").height()+2*w2utils.getSize(d,"+height");c<26&&(c=26),c>i.maxHeight&&(c=i.maxHeight),d.length>0&&(d[0].scrollTop=1e3);var h=w2utils.getSize(e(this.el),"height")-2;if(h>c&&(c=h),e(d).css({height:c+"px",overflow:c==i.maxHeight?"auto":"hidden"}),c<i.maxHeight&&e(d).prop("scrollTop",0),e(this.el).css({height:c+2+"px"}),"enum"===t.type){var f=t.helpers.multi.find("input");f.width(8*(f.val().length+2)+"px")}}return(new Date).getTime()-a},reset:function(){var e=this.type;this.clear(),this.type=e,this.init()},resize:function(){var t=this,i=e(t.el).width(),n=e(t.el).height();if(!(t.tmp.current_width==i&&n>0)){var a=this.helpers.focus,l=this.helpers.multi,s=this.helpers.suffix,o=this.helpers.prefix;if(a&&a.width(e(t.el).width()),l){var r=w2utils.getSize(t.el,"width")-parseInt(e(t.el).css("margin-left"),10)-parseInt(e(t.el).css("margin-right"),10);e(l).width(r)}s&&(t.options.suffix='<div class="arrow-down" style="margin-top: '+(parseInt(e(t.el).height())-6)/2+'px;"></div>',t.addSuffix()),o&&t.addPrefix(),t.tmp.current_width=i}},clean:function(t){if("number"==typeof t)return t;var i=this.options;return t=String(t).trim(),-1!==["int","float","money","currency","percent"].indexOf(this.type)&&("string"==typeof t&&(i.autoFormat&&-1!==["money","currency"].indexOf(this.type)&&(t=String(t).replace(i.moneyRE,"")),i.autoFormat&&"percent"===this.type&&(t=String(t).replace(i.percentRE,"")),i.autoFormat&&-1!==["int","float"].indexOf(this.type)&&(t=String(t).replace(i.numberRE,"")),t=t.replace(/\s+/g,"").replace(w2utils.settings.groupSymbol,"").replace(w2utils.settings.decimalSymbol,".")),parseFloat(t)==t&&(null!=i.min&&t<i.min&&(t=i.min,e(this.el).val(i.min)),null!=i.max&&t>i.max&&(t=i.max,e(this.el).val(i.max))),t=""!==t&&w2utils.isFloat(t)?Number(t):""),t},format:function(e){var t=this.options;if(t.autoFormat&&""!==e)switch(this.type){case"money":case"currency":""!==(e=w2utils.formatNumber(e,t.currencyPrecision,t.groupSymbol))&&(e=t.currencyPrefix+e+t.currencySuffix);break;case"percent":""!==(e=w2utils.formatNumber(e,t.precision,t.groupSymbol))&&(e+="%");break;case"float":e=w2utils.formatNumber(e,t.precision,t.groupSymbol);break;case"int":e=w2utils.formatNumber(e,0,t.groupSymbol)}return e},change:function(t){var i=this,n=i.options;if(-1!==["int","float","money","currency","percent"].indexOf(this.type)){var a=e(this.el).val(),l=this.format(this.clean(e(this.el).val()));if(""!==a&&a!=l)return e(this.el).val(l).change(),t.stopPropagation(),t.preventDefault(),!1}if("color"===this.type){var s=e(this.el).val();"rgb"!==s.substr(0,3).toLowerCase()&&(s="#"+s,6!==e(this.el).val().length&&3!==e(this.el).val().length&&(s="")),e(this.el).next().find("div").css("background-color",s),e(this.el).is(":focus")&&!0!==e(this.el).data("skipInit")&&this.updateOverlay()}if(-1!==["list","enum","file"].indexOf(this.type)&&(i.refresh(),setTimeout(function(){i.refresh()},5)),-1!==["date","time","datetime"].indexOf(this.type)){var o=parseInt(i.el.value);w2utils.isInt(i.el.value)&&o>3e3&&("time"===this.type&&e(i.el).val(w2utils.formatTime(new Date(o),n.format)).change(),"date"===this.type&&e(i.el).val(w2utils.formatDate(new Date(o),n.format)).change(),"datetime"===this.type&&e(i.el).val(w2utils.formatDateTime(new Date(o),n.format)).change())}},click:function(t){t.stopPropagation(),-1!==["list","combo","enum"].indexOf(this.type)&&(e(this.el).is(":focus")||this.focus(t)),-1!==["date","time","color","datetime"].indexOf(this.type)&&this.updateOverlay()},focus:function(t){var i=this;if(-1!==["color","date","time","datetime"].indexOf(i.type)){if(e(i.el).prop("readonly")||e(i.el).prop("disabled"))return;e("#w2ui-overlay").length>0&&e("#w2ui-overlay")[0].hide(),setTimeout(function(){i.updateOverlay()},150)}if(-1!==["list","combo","enum"].indexOf(i.type)){if(e(i.el).prop("readonly")||e(i.el).prop("disabled"))return;e("#w2ui-overlay").length>0&&e("#w2ui-overlay")[0].hide(),i.resize(),setTimeout(function(){"list"===i.type&&e(i.el).is(":focus")?e(i.helpers.focus).find("input").focus():(i.search(),setTimeout(function(){i.updateOverlay()},1))},1),"function"==typeof i.options._items_fun&&(i.options.items=w2obj.field.prototype.normMenu.call(this,i.options._items_fun))}"file"===i.type&&e(i.helpers.multi).css({outline:"auto 5px #7DB4F3","outline-offset":"-2px"})},blur:function(t){var i=this,n=i.options,a=e(i.el).val().trim(),l=e("#w2ui-overlay");if(-1!==["color","date","time","list","combo","enum","datetime"].indexOf(i.type)){var s=window.setTimeout(function(){!0!==l.data("keepOpen")&&l.hide()},0);e(".menu",l).one("focus",function(){clearTimeout(s),e(this).one("focusout",function(e){l.hide()})})}-1!==["int","float","money","currency","percent"].indexOf(i.type)&&(""===a||i.checkType(a)||(e(i.el).val("").change(),!1===n.silent&&(e(i.el).w2tag("Not a valid number"),setTimeout(function(){e(i.el).w2tag("")},3e3)))),-1!==["date","time","datetime"].indexOf(i.type)&&(""===a||i.inRange(i.el.value)?"date"!==i.type||""===a||w2utils.isDate(i.el.value,n.format)?"time"!==i.type||""===a||w2utils.isTime(i.el.value)?"datetime"!==i.type||""===a||w2utils.isDateTime(i.el.value,n.format)||(e(i.el).val("").removeData("selected").change(),!1===n.silent&&(e(i.el).w2tag("Not a valid date"),setTimeout(function(){e(i.el).w2tag("")},3e3))):(e(i.el).val("").removeData("selected").change(),!1===n.silent&&(e(i.el).w2tag("Not a valid time"),setTimeout(function(){e(i.el).w2tag("")},3e3))):(e(i.el).val("").removeData("selected").change(),!1===n.silent&&(e(i.el).w2tag("Not a valid date"),setTimeout(function(){e(i.el).w2tag("")},3e3))):(e(i.el).val("").removeData("selected").change(),!1===n.silent&&(e(i.el).w2tag("Not in range"),setTimeout(function(){e(i.el).w2tag("")},3e3)))),"enum"===i.type&&e(i.helpers.multi).find("input").val("").width(20),"file"===i.type&&e(i.helpers.multi).css({outline:"none"})},keyPress:function(e){var t=this;t.options;if(-1!==["int","float","money","currency","percent","hex","bin","color","alphanumeric"].indexOf(t.type)){if(e.metaKey||e.ctrlKey||e.altKey||e.charCode!=e.keyCode&&e.keyCode>0)return;var i=String.fromCharCode(e.charCode);if(!t.checkType(i,!0)&&13!=e.keyCode)return e.preventDefault(),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,!1}-1!==["date","time","datetime"].indexOf(t.type)&&9!==e.keyCode&&setTimeout(function(){t.updateOverlay()},1)},keyDown:function(t,i){var n=this,a=n.options,l=t.keyCode||i&&i.keyCode,s=!1;if(-1!==["int","float","money","currency","percent"].indexOf(n.type)){if(!a.keyboard||e(n.el).prop("readonly")||e(n.el).prop("disabled"))return;var o=parseFloat(e(n.el).val().replace(a.moneyRE,""))||0,r=a.step;switch((t.ctrlKey||t.metaKey)&&(r=10),l){case 38:if(t.shiftKey)break;e(n.el).val(o+r<=a.max||null==a.max?Number((o+r).toFixed(12)):a.max).change(),s=!0;break;case 40:if(t.shiftKey)break;e(n.el).val(o-r>=a.min||null==a.min?Number((o-r).toFixed(12)):a.min).change(),s=!0}s&&(t.preventDefault(),setTimeout(function(){n.el.setSelectionRange(n.el.value.length,n.el.value.length)},0))}if("date"===n.type){if(!a.keyboard||e(n.el).prop("readonly")||e(n.el).prop("disabled"))return;var d=864e5;r=1;switch((t.ctrlKey||t.metaKey)&&(r=10),(c=w2utils.isDate(e(n.el).val(),a.format,!0))||(c=new Date,d=0),l){case 38:if(t.shiftKey)break;var u=w2utils.formatDate(c.getTime()+d,a.format);10==r&&(u=w2utils.formatDate(new Date(c.getFullYear(),c.getMonth()+1,c.getDate()),a.format)),e(n.el).val(u).trigger("input").change(),s=!0;break;case 40:if(t.shiftKey)break;u=w2utils.formatDate(c.getTime()-d,a.format);10==r&&(u=w2utils.formatDate(new Date(c.getFullYear(),c.getMonth()-1,c.getDate()),a.format)),e(n.el).val(u).trigger("input").change(),s=!0}s&&(t.preventDefault(),setTimeout(function(){n.el.setSelectionRange(n.el.value.length,n.el.value.length),n.updateOverlay()},0))}if("time"===n.type){if(!a.keyboard||e(n.el).prop("readonly")||e(n.el).prop("disabled"))return;r=t.ctrlKey||t.metaKey?60:1,o=e(n.el).val();var p=n.toMin(o)||n.toMin((new Date).getHours()+":"+((new Date).getMinutes()-1));switch(l){case 38:if(t.shiftKey)break;p+=r,s=!0;break;case 40:if(t.shiftKey)break;p-=r,s=!0}s&&(e(n.el).val(n.fromMin(p)).trigger("input").change(),t.preventDefault(),setTimeout(function(){n.el.setSelectionRange(n.el.value.length,n.el.value.length)},0))}if("datetime"===n.type){if(!a.keyboard||e(n.el).prop("readonly")||e(n.el).prop("disabled"))return;d=864e5,r=1;(t.ctrlKey||t.metaKey)&&(r=10);var c,h=e(n.el).val();switch((c=w2utils.isDateTime(h,this.options.format,!0))||(c=new Date,d=0),l){case 38:if(t.shiftKey)break;u=w2utils.formatDateTime(c.getTime()+d,a.format);10==r&&(u=w2utils.formatDateTime(new Date(c.getFullYear(),c.getMonth()+1,c.getDate()),a.format)),e(n.el).val(u).trigger("input").change(),s=!0;break;case 40:if(t.shiftKey)break;u=w2utils.formatDateTime(c.getTime()-d,a.format);10==r&&(u=w2utils.formatDateTime(new Date(c.getFullYear(),c.getMonth()-1,c.getDate()),a.format)),e(n.el).val(u).trigger("input").change(),s=!0}s&&(t.preventDefault(),setTimeout(function(){n.el.setSelectionRange(n.el.value.length,n.el.value.length),n.updateOverlay()},0))}if("color"===n.type){if(e(n.el).prop("readonly")||e(n.el).prop("disabled"))return;if((t.ctrlKey||t.metaKey)&&!t.shiftKey){var f=null,m=null;switch(l){case 38:f="up";break;case 40:f="down";break;case 39:f="right";break;case 37:f="left"}n.el.nav&&null!=f&&(m=n.el.nav(f),e(n.el).val(m).change(),t.preventDefault())}}if(-1!==["list","combo","enum"].indexOf(n.type)){if(e(n.el).prop("readonly")||e(n.el).prop("disabled"))return;var g=e(n.el).data("selected"),v=e(n.el),y=!1;switch(-1!==["list","enum"].indexOf(n.type)&&("list"===n.type&&(v=e(n.helpers.focus).find("input")),"enum"===n.type&&(v=e(n.helpers.multi).find("input")),-1==[37,38,39,40].indexOf(l)&&setTimeout(function(){n.refresh()},1),86==t.keyCode&&(t.ctrlKey||t.metaKey)&&setTimeout(function(){n.refresh(),n.search(),n.request()},50)),l){case 27:"list"===n.type&&(""!==v.val()&&v.val(""),t.stopPropagation());break;case 37:case 39:break;case 13:if(0===e("#w2ui-overlay").length)break;var w=a.items[a.index];if("enum"===n.type)if(null!=w){if(!0===(x=n.trigger({phase:"before",type:"add",target:n.el,originalEvent:t.originalEvent,item:w})).isCancelled)return;w=x.item,g.length>=a.max&&a.max>0&&g.pop(),delete w.hidden,delete n.tmp.force_open,g.push(w),e(n.el).change(),v.val("").width(20),n.refresh(),n.trigger(e.extend(x,{phase:"after"}))}else{if(w={id:v.val(),text:v.val()},!0===(x=n.trigger({phase:"before",type:"new",target:n.el,originalEvent:t.originalEvent,item:w})).isCancelled)return;w=x.item,"function"==typeof n.onNew&&(g.length>=a.max&&a.max>0&&g.pop(),delete n.tmp.force_open,g.push(w),e(n.el).change(),v.val("").width(20),n.refresh()),n.trigger(e.extend(x,{phase:"after"}))}else w&&e(n.el).data("selected",w).val(w.text).change(),""===e(n.el).val()&&e(n.el).data("selected")&&e(n.el).removeData("selected").val("").change(),"list"===n.type&&(v.val(""),n.refresh()),n.tmp.force_hide=!0;break;case 8:case 46:if("enum"===n.type&&8===l&&""===v.val()&&g.length>0){var x;w=g[g.length-1];if(!0===(x=n.trigger({phase:"before",type:"remove",target:n.el,originalEvent:t.originalEvent,item:w})).isCancelled)return;g.pop(),e(n.el).trigger("input").trigger("change"),n.refresh(),n.trigger(e.extend(x,{phase:"after"}))}"list"===n.type&&""===v.val()&&(e(n.el).data("selected",{}).change(),n.refresh());break;case 38:for(a.index=w2utils.isInt(a.index)?parseInt(a.index):0,a.index--;a.index>0&&a.items[a.index].hidden;)a.index--;if(0===a.index&&a.items[a.index].hidden)for(;a.items[a.index]&&a.items[a.index].hidden;)a.index++;y=!0;break;case 40:for(a.index=w2utils.isInt(a.index)?parseInt(a.index):-1,a.index++;a.index<a.items.length-1&&a.items[a.index].hidden;)a.index++;if(a.index==a.items.length-1&&a.items[a.index].hidden)for(;a.items[a.index]&&a.items[a.index].hidden;)a.index--;""===v.val()&&0===e("#w2ui-overlay").length?n.tmp.force_open=!0:y=!0}if(y)return a.index<0&&(a.index=0),a.index>=a.items.length&&(a.index=a.items.length-1),n.updateOverlay(y),t.preventDefault(),void setTimeout(function(){if("enum"===n.type)(e=v.get(0)).setSelectionRange(e.value.length,e.value.length);else if("list"===n.type){var e;(e=v.get(0)).setSelectionRange(e.value.length,e.value.length)}else n.el.setSelectionRange(n.el.value.length,n.el.value.length)},0);"enum"===n.type&&v.width(8*(v.val().length+2)+"px")}},keyUp:function(t){if(-1!==["list","combo","enum"].indexOf(this.type)){if(e(this.el).prop("readonly")||e(this.el).prop("disabled"))return;if(-1==[16,17,18,20,37,39,91].indexOf(t.keyCode)){var i=e(this.helpers.focus).find("input");0===i.length&&(i=e(this.el));var n=this.trigger({phase:"before",type:"search",originalEvent:t,target:i,search:i.val()});if(!0===n.isCancelled)return;this.tmp.force_hide||this.request(),1==i.val().length&&this.refresh(),0!==e("#w2ui-overlay").length&&-1!=[38,40].indexOf(t.keyCode)||this.search(),this.trigger(e.extend(n,{phase:"after"}))}}},clearCache:function(){this.options.items=[],this.tmp.xhr_loading=!1,this.tmp.xhr_search="",this.tmp.xhr_total=-1},request:function(t){var i=this,n=this.options,a=e(i.el).val()||"";if(n.url){if("enum"===i.type){var l=e(i.helpers.multi).find("input");a=0===l.length?"":l.val()}if("list"===i.type){l=e(i.helpers.focus).find("input");a=0===l.length?"":l.val()}if(0!==n.minLength&&a.length<n.minLength)return n.items=[],void this.updateOverlay();null==t&&(t=n.interval),null==i.tmp.xhr_search&&(i.tmp.xhr_search=""),null==i.tmp.xhr_total&&(i.tmp.xhr_total=-1),n.url&&(0===n.items.length&&0!==i.tmp.xhr_total||i.tmp.xhr_total==n.cacheMax&&a.length>i.tmp.xhr_search.length||a.length>=i.tmp.xhr_search.length&&a.substr(0,i.tmp.xhr_search.length)!==i.tmp.xhr_search||a.length<i.tmp.xhr_search.length)&&(i.tmp.xhr&&i.tmp.xhr.abort(),i.tmp.xhr_loading=!0,i.search(),clearTimeout(i.tmp.timeout),i.tmp.timeout=setTimeout(function(){var t=n.url,l={search:a,max:n.cacheMax};e.extend(l,n.postData);var s=i.trigger({phase:"before",type:"request",search:a,target:i.el,url:t,postData:l});if(!0!==s.isCancelled){var o={type:"GET",url:t=s.url,data:l=s.postData,dataType:"JSON"};n.method&&(o.type=n.method),"JSON"===w2utils.settings.dataType&&(o.type="POST",o.data=JSON.stringify(o.data),o.contentType="application/json"),"HTTPJSON"===w2utils.settings.dataType&&(o.data={request:JSON.stringify(o.data)}),null!=n.method&&(o.type=n.method),i.tmp.xhr=e.ajax(o).done(function(t,s,o){var r=i.trigger({phase:"before",type:"load",target:i.el,search:l.search,data:t,xhr:o});if(!0!==r.isCancelled)if("string"==typeof(t=r.data)&&(t=JSON.parse(t)),null==t.records&&null!=t.items&&(t.records=t.items,delete t.items),"success"===t.status&&null==t.records&&(t.records=[]),"success"===t.status&&Array.isArray(t.records)){t.records.length>n.cacheMax&&t.records.splice(n.cacheMax,1e5),null==n.recId&&null!=n.recid&&(n.recId=n.recid),(n.recId||n.recText)&&t.records.forEach(function(e){"string"==typeof n.recId&&(e.id=e[n.recId]),"function"==typeof n.recId&&(e.id=n.recId(e)),"string"==typeof n.recText&&(e.text=e[n.recText]),"function"==typeof n.recText&&(e.text=n.recText(e))}),i.tmp.xhr_loading=!1,i.tmp.xhr_search=a,i.tmp.xhr_total=t.records.length,n.items=i.normMenu(t.records),""===a&&0===t.records.length?i.tmp.emptySet=!0:i.tmp.emptySet=!1;var d,u=e(i.el).data("find_selected");if(u)Array.isArray(u)?(d=[],u.forEach(function(t){n.items.forEach(function(i){i.id==t&&d.push(e.extend(!0,{},i))})})):n.items.forEach(function(e){e.id==u&&(d=e)}),e(i.el).data("selected",d).removeData("find_selected").change();i.search(),i.trigger(e.extend(r,{phase:"after"}))}else console.log("ERROR: server did not return proper structure. It should return",{status:"success",records:[{id:1,text:"item"}]})}).fail(function(t,l,s){var o={status:l,error:s,rawResponseText:t.responseText},r=i.trigger({phase:"before",type:"error",target:i.el,search:a,error:o,xhr:t});if(!0!==r.isCancelled){if("abort"!==l){var d;try{d=e.parseJSON(t.responseText)}catch(e){}console.log("ERROR: Server communication failed.","\n   EXPECTED:",{status:"success",records:[{id:1,text:"item"}]},"\n         OR:",{status:"error",message:"error message"},"\n   RECEIVED:","object"==typeof d?d:t.responseText)}i.tmp.xhr_loading=!1,i.tmp.xhr_search=a,i.tmp.xhr_total=0,n.items=[],i.clearCache(),i.search(),i.updateOverlay(!1,'<div style="white-space: normal; line-height: 1.3">'+(r.error||"Server communication failed")+"</div>"),i.trigger(e.extend(r,{phase:"after"}))}}),i.trigger(e.extend(s,{phase:"after"}))}},t))}},search:function(){var t=this,i=this.options,n=e(t.el).val(),a=t.el,l=[],s=e(t.el).data("selected");if("enum"===t.type)for(var o in a=e(t.helpers.multi).find("input"),n=a.val(),s)s[o]&&l.push(s[o].id);else if("list"===t.type)for(var o in a=e(t.helpers.focus).find("input"),n=a.val(),s)s[o]&&l.push(s[o].id);var r=i.items;if(!0!==t.tmp.xhr_loading){for(var d=0,u=0;u<r.length;u++){var p=r[u];if(null!=i.compare)"function"==typeof i.compare&&(p.hidden=!1===i.compare.call(this,p,n));else{var c="",h="";-1!==["is","begins"].indexOf(i.match)&&(c="^"),-1!==["is","ends"].indexOf(i.match)&&(h="$");try{new RegExp(c+n+h,"i").test(p.text)||"..."===p.text?p.hidden=!1:p.hidden=!0}catch(e){}}!1===i.filter&&(p.hidden=!1),"enum"===t.type&&-1!==e.inArray(p.id,l)&&(p.hidden=!0),!0!==p.hidden&&(d++,delete p.hidden)}for(i.index=-1;r[i.index]&&r[i.index].hidden;)i.index++;d<=0&&(i.index=-1),i.spinner=!1,t.updateOverlay(),setTimeout(function(){var t=e("#w2ui-overlay").html()||"";i.markSearch&&-1!==t.indexOf("$.fn.w2menuHandler")&&e("#w2ui-overlay").w2marker(n)},1)}else r.splice(0,i.cacheMax),i.spinner=!0,t.updateOverlay()},updateOverlay:function(t,i){var n=this,a=this.options;if("color"===this.type){if(e(n.el).prop("readonly")||e(n.el).prop("disabled"))return;e(this.el).w2color({color:e(this.el).val(),transparent:a.transparent,advanced:a.advanced},function(t){null!=t&&e(n.el).val(t).trigger("input").change()})}if("date"===this.type){if(e(n.el).prop("readonly")||e(n.el).prop("disabled"))return;0===e("#w2ui-overlay").length&&e(n.el).w2overlay('<div class="w2ui-reset w2ui-calendar"></div>',{css:{"background-color":"#f5f5f5"},onShow:function(t){w2utils.isIE&&(console.log("IE"),e(".w2ui-calendar").on("mousedown",function(t){var i=e(t.target);1===i.length&&"w2ui-jump-year"===i[0].id&&e("#w2ui-overlay").data("keepOpen",!0)}))}}),(r=w2utils.isDate(e(n.el).val(),n.options.format,!0))&&(s=r.getMonth()+1,o=r.getFullYear()),function t(i,a){e("#w2ui-overlay > div > div").html(n.getMonthHTML(i,a,e(n.el).val())),e("#w2ui-overlay .w2ui-calendar-title").on("mousedown",function(){var i,a;e(this).next().hasClass("w2ui-calendar-jump")?e(this).next().remove():(e(this).after('<div class="w2ui-calendar-jump" style=""></div>'),e(this).next().hide().html(n.getYearHTML()).fadeIn(200),setTimeout(function(){e("#w2ui-overlay .w2ui-calendar-jump").find(".w2ui-jump-month, .w2ui-jump-year").on("click",function(){e(this).hasClass("w2ui-jump-month")&&(e(this).parent().find(".w2ui-jump-month").removeClass("selected"),e(this).addClass("selected"),a=e(this).attr("name")),e(this).hasClass("w2ui-jump-year")&&(e(this).parent().find(".w2ui-jump-year").removeClass("selected"),e(this).addClass("selected"),i=e(this).attr("name")),null!=i&&null!=a&&(e("#w2ui-overlay .w2ui-calendar-jump").fadeOut(100),setTimeout(function(){t(parseInt(a)+1,i)},100))}),e("#w2ui-overlay .w2ui-calendar-jump >:last-child").prop("scrollTop",2e3)},1))}),e("#w2ui-overlay .w2ui-date").on("mousedown",function(){var t=e(this).attr("date");e(n.el).val(t).trigger("input").change(),e(this).css({"background-color":"#B6D5FB","border-color":"#aaa"})}).on("mouseup",function(){setTimeout(function(){e("#w2ui-overlay").length>0&&e("#w2ui-overlay").removeData("keepOpen")[0].hide()},10)}),e("#w2ui-overlay .previous").on("mousedown",function(){var e=n.options.current.split("/");e[0]=parseInt(e[0])-1,t(e[0],e[1])}),e("#w2ui-overlay .next").on("mousedown",function(){var e=n.options.current.split("/");e[0]=parseInt(e[0])+1,t(e[0],e[1])})}(s,o)}if("time"===this.type){if(e(n.el).prop("readonly")||e(n.el).prop("disabled"))return;0===e("#w2ui-overlay").length&&e(n.el).w2overlay('<div class="w2ui-reset w2ui-calendar-time" onclick="event.stopPropagation();"></div>',{css:{"background-color":"#fff"}});var l="h24"===this.options.format;e("#w2ui-overlay > div").html(n.getHourHTML()),e("#w2ui-overlay .w2ui-time").on("mousedown",function(t){e(this).css({"background-color":"#B6D5FB","border-color":"#aaa"});var i=e(this).attr("hour");e(n.el).val((i>12&&!l?i-12:i)+":00"+(l?"":i<12?" am":" pm")).trigger("input").change()}),null==this.options.noMinutes||!1===this.options.noMinutes?e("#w2ui-overlay .w2ui-time").on("mouseup",function(){var t=e(this).attr("hour");e("#w2ui-overlay").length>0&&e("#w2ui-overlay")[0].hide(),e(n.el).w2overlay('<div class="w2ui-reset w2ui-calendar-time"></div>',{css:{"background-color":"#fff"}}),e("#w2ui-overlay > div").html(n.getMinHTML(t)),e("#w2ui-overlay .w2ui-time").on("mousedown",function(){e(this).css({"background-color":"#B6D5FB","border-color":"#aaa"});var i=e(this).attr("min");e(n.el).val((t>12&&!l?t-12:t)+":"+(i<10?0:"")+i+(l?"":t<12?" am":" pm")).trigger("input").change()}).on("mouseup",function(){setTimeout(function(){e("#w2ui-overlay").length>0&&e("#w2ui-overlay").removeData("keepOpen")[0].hide()},10)})}):e("#w2ui-overlay .w2ui-time").on("mouseup",function(){setTimeout(function(){e("#w2ui-overlay").length>0&&e("#w2ui-overlay").removeData("keepOpen")[0].hide()},10)})}if("datetime"===this.type){if(e(n.el).prop("readonly")||e(n.el).prop("disabled"))return;var s,o,r;e("#w2ui-overlay .w2ui-time").length>0&&e("#w2ui-overlay")[0].hide(),0===e("#w2ui-overlay").length&&e(n.el).w2overlay('<div class="w2ui-reset w2ui-calendar" onclick="event.stopPropagation();"></div>',{css:{"background-color":"#f5f5f5"},onShow:function(t){w2utils.isIE&&(console.log("IE"),e(".w2ui-calendar").on("mousedown",function(t){var i=e(t.target);1===i.length&&"w2ui-jump-year"===i[0].id&&e("#w2ui-overlay").data("keepOpen",!0)}))}}),(r=w2utils.isDateTime(e(n.el).val(),n.options.format,!0))&&(s=r.getMonth()+1,o=r.getFullYear());var d=null;!function t(i,l){e("#w2ui-overlay > div > div").html(n.getMonthHTML(i,l,e(n.el).val())+(a.btn_now?'<div class="w2ui-calendar-now now">'+w2utils.lang("Current Date & Time")+"</div>":"")),e("#w2ui-overlay .w2ui-calendar-title").on("mousedown",function(){var i,a;e(this).next().hasClass("w2ui-calendar-jump")?e(this).next().remove():(e(this).after('<div class="w2ui-calendar-jump" style=""></div>'),e(this).next().hide().html(n.getYearHTML()).fadeIn(200),setTimeout(function(){e("#w2ui-overlay .w2ui-calendar-jump").find(".w2ui-jump-month, .w2ui-jump-year").on("click",function(){e(this).hasClass("w2ui-jump-month")&&(e(this).parent().find(".w2ui-jump-month").removeClass("selected"),e(this).addClass("selected"),a=e(this).attr("name")),e(this).hasClass("w2ui-jump-year")&&(e(this).parent().find(".w2ui-jump-year").removeClass("selected"),e(this).addClass("selected"),i=e(this).attr("name")),null!=i&&null!=a&&(e("#w2ui-overlay .w2ui-calendar-jump").fadeOut(100),setTimeout(function(){t(parseInt(a)+1,i)},100))}),e("#w2ui-overlay .w2ui-calendar-jump >:last-child").prop("scrollTop",2e3)},1))}),e("#w2ui-overlay .w2ui-date").on("mousedown",function(){var t=e(this).attr("date");e(n.el).val(t).trigger("input").change(),e(this).css({"background-color":"#B6D5FB","border-color":"#aaa"}),d=new Date(e(this).attr("data-date"))}).on("mouseup",function(){var t,i;e("#w2ui-overlay").length>0&&e("#w2ui-overlay")[0].hide(),e(n.el).w2overlay('<div class="w2ui-reset w2ui-calendar-time"></div>',{css:{"background-color":"#fff"}});n.options.format;e("#w2ui-overlay > div").html(n.getHourHTML()),e("#w2ui-overlay .w2ui-time").on("mousedown",function(i){e(this).css({"background-color":"#B6D5FB","border-color":"#aaa"}),t=e(this).attr("hour"),d.setHours(t);var a=w2utils.formatDateTime(d,n.options.format);e(n.el).val(a).trigger("input").change()}),null==n.options.noMinutes||!1===n.options.noMinutes?e("#w2ui-overlay .w2ui-time").on("mouseup",function(){var a=e(this).attr("hour");e("#w2ui-overlay").length>0&&e("#w2ui-overlay")[0].hide(),e(n.el).w2overlay('<div class="w2ui-reset w2ui-calendar-time"></div>',{css:{"background-color":"#fff"}}),e("#w2ui-overlay > div").html(n.getMinHTML(a)),e("#w2ui-overlay .w2ui-time").on("mousedown",function(){e(this).css({"background-color":"#B6D5FB","border-color":"#aaa"}),i=e(this).attr("min"),d.setHours(t,i);var a=w2utils.formatDateTime(d,n.options.format);e(n.el).val(a).trigger("input").change()}).on("mouseup",function(){setTimeout(function(){e("#w2ui-overlay").length>0&&e("#w2ui-overlay").removeData("keepOpen")[0].hide()},10)})}):e("#w2ui-overlay .w2ui-time").on("mouseup",function(){setTimeout(function(){e("#w2ui-overlay").length>0&&e("#w2ui-overlay").removeData("keepOpen")[0].hide()},10)})}),e("#w2ui-overlay .previous").on("mousedown",function(){var e=n.options.current.split("/");e[0]=parseInt(e[0])-1,t(e[0],e[1])}),e("#w2ui-overlay .next").on("mousedown",function(){var e=n.options.current.split("/");e[0]=parseInt(e[0])+1,t(e[0],e[1])}),e("#w2ui-overlay .now").on("mousedown",function(){var t=w2utils.formatDateTime(new Date,n.options.format);return e(n.el).val(t).trigger("input").change(),!1}).on("mouseup",function(){setTimeout(function(){e("#w2ui-overlay").length>0&&e("#w2ui-overlay").removeData("keepOpen")[0].hide()},10)})}(s,o)}if(-1!==["list","combo","enum"].indexOf(this.type)){var u=this.el,p=this.el;if("enum"===this.type&&(u=e(this.helpers.multi),p=e(u).find("input")),"list"===this.type){var c=e(p).data("selected");e.isPlainObject(c)&&!e.isEmptyObject(c)&&-1==a.index&&a.items.forEach(function(e,t){e.id===c.id&&(a.index=t)}),p=e(this.helpers.focus).find("input")}if(e(p).is(":focus")){if(!1===a.openOnFocus&&""===e(p).val()&&!0!==n.tmp.force_open)return void e().w2overlay();if(n.tmp.force_hide)return e().w2overlay(),void setTimeout(function(){delete n.tmp.force_hide},1);""!==e(p).val()&&delete n.tmp.force_open;var h=w2utils.lang("No matches");null!=a.url&&e(p).val().length<a.minLength&&!0!==n.tmp.emptySet&&(h=a.minLength+" "+w2utils.lang("letters or more...")),null!=a.url&&""===e(p).val()&&!0!==n.tmp.emptySet&&(h=w2utils.lang("Type to search...")),null==a.url&&0===a.items.length&&(h=w2utils.lang("Empty list")),null!=a.msgNoItems&&(h=a.msgNoItems),"function"==typeof h&&(h=h(a)),i&&(h=i);var f=e.extend(!0,{},a,{search:!1,render:a.renderDrop,maxHeight:a.maxDropHeight,maxWidth:a.maxDropWidth,msgNoItems:h,onSelect:function(t){if("enum"===n.type){var i=e(n.el).data("selected");if(t.item){var l=n.trigger({phase:"before",type:"add",target:n.el,originalEvent:t.originalEvent,item:t.item});if(!0===l.isCancelled)return;i.length>=a.max&&a.max>0&&i.pop(),delete t.item.hidden,i.push(t.item),e(n.el).data("selected",i).trigger("input").change(),e(n.helpers.multi).find("input").val("").width(20),n.refresh(),e("#w2ui-overlay").length>0&&e("#w2ui-overlay")[0].hide(),n.trigger(e.extend(l,{phase:"after"}))}}else e(n.el).data("selected",t.item).val(t.item.text).trigger("input").change(),n.helpers.focus&&n.helpers.focus.find("input").val("")}});e(u).w2menu(t?"refresh-index":"refresh",f)}}},inRange:function(t,i){var n=!1;if("date"===this.type){if(f=w2utils.isDate(t,this.options.format,!0)){if(this.options.start||this.options.end){var a="string"==typeof this.options.start?this.options.start:e(this.options.start).val(),l="string"==typeof this.options.end?this.options.end:e(this.options.end).val(),s=w2utils.isDate(a,this.options.format,!0),o=w2utils.isDate(l,this.options.format,!0),r=new Date(f);s||(s=r),o||(o=r),r>=s&&r<=o&&(n=!0)}else n=!0;if(this.options.blocked&&-1!==e.inArray(t,this.options.blocked)&&(n=!1),null!==this.options.blockWeekDays&&void 0!==this.options.blockWeekDays&&null!=this.options.blockWeekDays.length)for(var d=this.options.blockWeekDays.length,u=0;u<d;u++)f.getDay()==this.options.blockWeekDays[u]&&(n=!1)}}else if("time"===this.type)if(this.options.start||this.options.end){var p=this.toMin(t),c=this.toMin(this.options.start),h=this.toMin(this.options.end);c||(c=p),h||(h=p),p>=c&&p<=h&&(n=!0)}else n=!0;else if("datetime"===this.type){var f;if(f=w2utils.isDateTime(t,this.options.format,!0)){if(this.options.start||this.options.end){if("object"==typeof this.options.start&&this.options.start instanceof Date)s=this.options.start;else s=""!==(a="string"==typeof this.options.start?this.options.start:e(this.options.start).val()).trim()?w2utils.isDateTime(a,this.options.format,!0):"";if("object"==typeof this.options.end&&this.options.end instanceof Date)o=this.options.end;else o=""!==(l="string"==typeof this.options.end?this.options.end:e(this.options.end).val()).trim()?w2utils.isDateTime(l,this.options.format,!0):"";r=f;s||(s=r),o||(o=r),i&&s instanceof Date&&(s.setHours(0),s.setMinutes(0),s.setSeconds(0)),r>=s&&r<=o&&(n=!0)}else n=!0;if(n&&this.options.blocked)for(u=0;u<this.options.blocked.length;u++){var m=this.options.blocked[u];if("string"==typeof m&&(m=w2utils.isDateTime(m,this.options.format,!0)),"object"==typeof m&&m instanceof Date&&m.getFullYear()==f.getFullYear()&&m.getMonth()==f.getMonth()&&m.getDate()==f.getDate()){n=!1;break}}}}return n},checkType:function(e,t){var i=this;switch(i.type){case"int":return!(!t||-1===["-",i.options.groupSymbol].indexOf(e))||w2utils.isInt(e.replace(i.options.numberRE,""));case"percent":e=e.replace(/%/g,"");case"float":return!(!t||-1===["-",w2utils.settings.decimalSymbol,i.options.groupSymbol].indexOf(e))||w2utils.isFloat(e.replace(i.options.numberRE,""));case"money":case"currency":return!(!t||-1===["-",i.options.decimalSymbol,i.options.groupSymbol,i.options.currencyPrefix,i.options.currencySuffix].indexOf(e))||w2utils.isFloat(e.replace(i.options.moneyRE,""));case"bin":return w2utils.isBin(e);case"hex":return w2utils.isHex(e);case"alphanumeric":return w2utils.isAlphaNumeric(e)}return!0},addPrefix:function(){var t=this;setTimeout(function(){if("clear"!==t.type){var i,n=e(t.el).data("tmp")||{};n["old-padding-left"]&&e(t.el).css("padding-left",n["old-padding-left"]),n["old-padding-left"]=e(t.el).css("padding-left"),e(t.el).data("tmp",n),t.helpers.prefix&&e(t.helpers.prefix).remove(),""!==t.options.prefix&&(e(t.el).before('<div class="w2ui-field-helper">'+t.options.prefix+"</div>"),(i=e(t.el).prev()).css({color:e(t.el).css("color"),"font-family":e(t.el).css("font-family"),"font-size":e(t.el).css("font-size"),"padding-top":e(t.el).css("padding-top"),"padding-bottom":e(t.el).css("padding-bottom"),"padding-left":e(t.el).css("padding-left"),"padding-right":0,"margin-top":parseInt(e(t.el).css("margin-top"),10)+2+"px","margin-bottom":parseInt(e(t.el).css("margin-bottom"),10)+1+"px","margin-left":e(t.el).css("margin-left"),"margin-right":0}).on("click",function(i){if(t.options.icon&&"function"==typeof t.onIconClick){var n=t.trigger({phase:"before",type:"iconClick",target:t.el,el:e(this).find("span.w2ui-icon")[0]});if(!0===n.isCancelled)return;t.trigger(e.extend(n,{phase:"after"}))}else"list"===t.type?e(t.helpers.focus).find("input").focus():e(t.el).focus()}),e(t.el).css("padding-left",i.width()+parseInt(e(t.el).css("padding-left"),10)+"px"),t.helpers.prefix=i)}},1)},addSuffix:function(){var t,i,n=this;setTimeout(function(){if("clear"!==n.type){var a=e(n.el).data("tmp")||{};a["old-padding-right"]&&e(n.el).css("padding-right",a["old-padding-right"]),a["old-padding-right"]=e(n.el).css("padding-right"),e(n.el).data("tmp",a),i=parseInt(e(n.el).css("padding-right"),10),n.options.arrows&&(n.helpers.arrows&&e(n.helpers.arrows).remove(),e(n.el).after('<div class="w2ui-field-helper" style="border: 1px solid transparent">&#160;    <div class="w2ui-field-up" type="up">        <div class="arrow-up" type="up"></div>    </div>    <div class="w2ui-field-down" type="down">        <div class="arrow-down" type="down"></div>    </div></div>'),(t=e(n.el).next()).css({color:e(n.el).css("color"),"font-family":e(n.el).css("font-family"),"font-size":e(n.el).css("font-size"),height:e(n.el).height()+parseInt(e(n.el).css("padding-top"),10)+parseInt(e(n.el).css("padding-bottom"),10)+"px",padding:0,"margin-top":parseInt(e(n.el).css("margin-top"),10)+1+"px","margin-bottom":0,"border-left":"1px solid silver"}).css("margin-left","-"+(t.width()+parseInt(e(n.el).css("margin-right"),10)+12)+"px").on("mousedown",function(t){var i=e("body");function a(i){e(n.el).focus(),n.keyDown(e.Event("keydown"),{keyCode:"up"===e(t.target).attr("type")?38:40}),!1!==i&&e("body").data("_field_update_timer",setTimeout(a,60))}i.on("mouseup",function e(){clearTimeout(i.data("_field_update_timer"));i.off("mouseup",e)}),i.data("_field_update_timer",setTimeout(a,700)),a(!1)}),i+=t.width()+12,e(n.el).css("padding-right",i+"px"),n.helpers.arrows=t),""!==n.options.suffix&&(n.helpers.suffix&&e(n.helpers.suffix).remove(),e(n.el).after('<div class="w2ui-field-helper">'+n.options.suffix+"</div>"),(t=e(n.el).next()).css({color:e(n.el).css("color"),"font-family":e(n.el).css("font-family"),"font-size":e(n.el).css("font-size"),"padding-top":e(n.el).css("padding-top"),"padding-bottom":e(n.el).css("padding-bottom"),"padding-left":"3px","padding-right":e(n.el).css("padding-right"),"margin-top":parseInt(e(n.el).css("margin-top"),10)+2+"px","margin-bottom":parseInt(e(n.el).css("margin-bottom"),10)+1+"px"}).on("click",function(t){"list"===n.type?e(n.helpers.focus).find("input").focus():e(n.el).focus()}),t.css("margin-left","-"+(w2utils.getSize(t,"width")+parseInt(e(n.el).css("margin-right"),10)+2)+"px"),i+=t.width()+3,e(n.el).css("padding-right",i+"px"),n.helpers.suffix=t)}},1)},addFocus:function(){var t,i=this;this.options;e(i.helpers.focus).remove();var n=parseInt(e(i.el).attr("tabIndex"));isNaN(n)||-1===n||(i.el._tabIndex=n),i.el._tabIndex&&(n=i.el._tabIndex),null==n&&(n=-1);var a='<div class="w2ui-field-helper">    <div class="w2ui-icon icon-search" style="opacity: 0; display: none"></div>    <input type="text" autocomplete="off" tabIndex="'+n+'"/></div>';e(i.el).attr("tabindex",-1).before(a);var l=e(i.el).prev();i.helpers.focus=l,l.css({width:e(i.el).width(),"margin-top":e(i.el).css("margin-top"),"margin-left":parseInt(e(i.el).css("margin-left"))+parseInt(e(i.el).css("padding-left"))+"px","margin-bottom":e(i.el).css("margin-bottom"),"margin-right":e(i.el).css("margin-right")}).find("input").css({cursor:"default",width:"100%",outline:"none",opacity:1,margin:0,border:"1px solid transparent",padding:e(i.el).css("padding-top"),"padding-left":0,"margin-left":0,"background-color":"transparent"}),l.find("input").on("click",function(t){0===e("#w2ui-overlay").length&&i.focus(t),t.stopPropagation()}).on("focus",function(n){t=e(i.el).attr("placeholder"),e(i.el).css({outline:"auto 5px #7DB4F3","outline-offset":"-2px"}),e(this).val(""),e(i.el).triggerHandler("focus"),n.stopPropagation?n.stopPropagation():n.cancelBubble=!0}).on("blur",function(n){e(i.el).css("outline","none"),e(this).val(""),i.refresh(),e(i.el).triggerHandler("blur"),n.stopPropagation?n.stopPropagation():n.cancelBubble=!0,null!=t&&e(i.el).attr("placeholder",t)}).on("keydown",function(n){var a=this;i.keyDown(n),setTimeout(function(){""===a.value?e(i.el).attr("placeholder",t):e(i.el).attr("placeholder","")},10)}).on("keyup",function(e){i.keyUp(e)}).on("keypress",function(e){i.keyPress(e)}),l.on("click",function(t){e(this).find("input").focus()}),i.refresh()},addMulti:function(){var t=this;this.options;e(t.helpers.multi).remove();var i="",n="margin-top     : 0px; margin-bottom  : 0px; margin-left    : "+e(t.el).css("margin-left")+"; margin-right   : "+e(t.el).css("margin-right")+"; width          : "+(w2utils.getSize(t.el,"width")-parseInt(e(t.el).css("margin-left"),10)-parseInt(e(t.el).css("margin-right"),10))+"px;";if("enum"===t.type){var a=e(t.el).attr("tabIndex");a&&-1!==a&&(t.el._tabIndex=a),t.el._tabIndex&&(a=t.el._tabIndex),null==a&&(a=-1),i='<div class="w2ui-field-helper w2ui-list" style="'+n+'; box-sizing: border-box">    <div style="padding: 0px; margin: 0px; display: inline-block" class="w2ui-multi-items">    <ul>        <li style="padding-left: 0px; padding-right: 0px" class="nomouse">            <input type="text" style="width: 20px; margin: -3px 0 0; padding: 2px 0; border-color: white" autocomplete="off"'+(e(t.el).prop("readonly")?' readonly="readonly"':"")+(e(t.el).prop("disabled")?' disabled="disabled"':"")+' tabindex="'+a+'"/>        </li>    </ul>    </div></div>'}"file"===t.type&&(i='<div class="w2ui-field-helper w2ui-list" style="'+n+'; box-sizing: border-box">   <div style="position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px;">       <input class="file-input" type="file" style="width: 100%; height: 100%; opacity: 0;" name="attachment" tabindex="-1"'+(1!==t.options.max?' multiple="multiple"':"")+(e(t.el).prop("readonly")?' readonly="readonly"':"")+(e(t.el).prop("disabled")?' disabled="disabled"':"")+(e(t.el).attr("accept")?' accept="'+e(t.el).attr("accept")+'"':"")+'/>   </div>    <div style="position: absolute; padding: 0px; margin: 0px; display: inline-block" class="w2ui-multi-items">        <ul><li style="padding-left: 0px; padding-right: 0px" class="nomouse"></li></ul>    </div></div>');var l=e(t.el).data("tmp")||{};l["old-background-color"]=e(t.el).css("background-color"),l["old-border-color"]=e(t.el).css("border-color"),e(t.el).data("tmp",l),e(t.el).before(i).css({"background-color":"transparent","border-color":"transparent"});var s=e(t.el).prev();t.helpers.multi=s,"enum"===t.type&&(e(t.el).attr("tabindex",-1),s.find("input").on("click",function(i){0===e("#w2ui-overlay").length&&t.focus(i),e(t.el).triggerHandler("click")}).on("focus",function(i){e(s).css({outline:"auto 5px #7DB4F3","outline-offset":"-2px"}),e(t.el).triggerHandler("focus"),i.stopPropagation?i.stopPropagation():i.cancelBubble=!0}).on("blur",function(i){e(s).css("outline","none"),e(t.el).triggerHandler("blur"),i.stopPropagation?i.stopPropagation():i.cancelBubble=!0}).on("keyup",function(e){t.keyUp(e)}).on("keydown",function(e){t.keyDown(e)}).on("keypress",function(e){t.keyPress(e)}),s.on("click",function(t){e(this).find("input").focus()})),"file"===t.type&&(e(t.el).css("outline","none"),s.on("click",function(i){e(t.el).focus(),e(t.el).prop("readonly")||e(t.el).prop("disabled")||(t.blur(i),t.resize(),setTimeout(function(){s.find("input").click()},10))}).on("dragenter",function(i){e(t.el).prop("readonly")||e(t.el).prop("disabled")||e(s).addClass("w2ui-file-dragover")}).on("dragleave",function(i){e(t.el).prop("readonly")||e(t.el).prop("disabled")||0===e(i.target).parents(".w2ui-field-helper").length&&e(s).removeClass("w2ui-file-dragover")}).on("drop",function(i){if(!e(t.el).prop("readonly")&&!e(t.el).prop("disabled")){e(s).removeClass("w2ui-file-dragover");for(var n=i.originalEvent.dataTransfer.files,a=0,l=n.length;a<l;a++)t.addFile.call(t,n[a]);i.preventDefault(),i.stopPropagation()}}).on("dragover",function(e){e.preventDefault(),e.stopPropagation()}),s.find("input").on("click",function(e){e.stopPropagation()}).on("change",function(){if(void 0!==this.files)for(var e=0,i=this.files.length;e<i;e++)t.addFile.call(t,this.files[e])})),t.refresh()},addFile:function(t){var i,n=this,a=this.options,l=e(n.el).data("selected"),s={name:t.name,type:t.type,modified:t.lastModifiedDate,size:t.size,content:null,file:t},o=0,r=0;if(l)for(var d=0;d<l.length;d++){if(l[d].name==t.name&&l[d].size==t.size)return;o+=l[d].size,r++}var u=n.trigger({phase:"before",type:"add",target:n.el,file:s,total:r,totalSize:o});if(!0!==u.isCancelled){if(0!==a.maxFileSize&&s.size>a.maxFileSize)return i="Maximum file size is "+w2utils.formatSize(a.maxFileSize),!1===a.silent&&e(n.el).w2tag(i),void console.log("ERROR: "+i);if(0!==a.maxSize&&o+s.size>a.maxSize)return i=w2utils.lang("Maximum total size is")+" "+w2utils.formatSize(a.maxSize),void(!1===a.silent?e(n.el).w2tag(i):console.log("ERROR: "+i));if(0!==a.max&&r>=a.max)return i=w2utils.lang("Maximum number of files is")+" "+a.max,void(!1===a.silent?e(n.el).w2tag(i):console.log("ERROR: "+i));if(l.push(s),"undefined"!=typeof FileReader&&!0===a.readContent){var p=new FileReader;p.onload=function(t){var i=t.target.result,a=i.indexOf(",");s.content=i.substr(a+1),n.refresh(),e(n.el).trigger("input").trigger("change"),n.trigger(e.extend(u,{phase:"after"}))},p.readAsDataURL(t)}else n.refresh(),e(n.el).trigger("input").trigger("change"),n.trigger(e.extend(u,{phase:"after"}))}},normMenu:function(t,i){if(e.isArray(t)){for(var n=0;n<t.length;n++)"string"==typeof t[n]?t[n]={id:t[n],text:t[n]}:null!=t[n]?(null!=t[n].text&&null==t[n].id&&(t[n].id=t[n].text),null==t[n].text&&null!=t[n].id&&(t[n].text=t[n].id),null!=t[n].caption&&(t[n].text=t[n].caption)):t[n]={id:null,text:"null"};return t}if("function"==typeof t)return w2obj.field.prototype.normMenu.call(this,t.call(this,i));if("object"==typeof t){var a=[];for(var n in t)a.push({id:n,text:t[n]});return a}},getMonthHTML:function(e,t,i){var n=new Date,a=w2utils.settings.fullmonths,l=["31","28","31","30","31","30","31","31","30","31","30","31"],s=n.getFullYear()+"/"+(Number(n.getMonth())+1)+"/"+n.getDate(),o=w2utils.settings.fulldays.slice(),r=w2utils.settings.shortdays.slice();"M"!==w2utils.settings.weekStarts&&(o.unshift(o.pop()),r.unshift(r.pop()));var d=this.options;null==d&&(d={}),t=w2utils.isInt(t)?parseInt(t):n.getFullYear(),(e=w2utils.isInt(e)?parseInt(e):n.getMonth()+1)>12&&(e-=12,t++),(e<1||0===e)&&(e+=12,t--),t/4==Math.floor(t/4)?l[1]="29":l[1]="28",d.current=e+"/"+t;for(var u=(n=new Date(t,e-1,1)).getDay(),p="",c=0;c<r.length;c++)p+='<td title="'+o[c]+'">'+r[c]+"</td>";var h='<div class="w2ui-calendar-title title">    <div class="w2ui-calendar-previous previous"> <div></div> </div>    <div class="w2ui-calendar-next next"> <div></div> </div> '+a[e-1]+", "+t+'</div><table class="w2ui-calendar-days" cellspacing="0"><tbody>    <tr class="w2ui-day-title">'+p+"</tr>    <tr>",f=1;if("M"!==w2utils.settings.weekStarts&&u++,"datetime"===this.type){var m=w2utils.isDateTime(i,d.format,!0);i=w2utils.formatDate(m,w2utils.settings.dateFormat)}for(var g=1;g<43;g++){if(0===u&&1==g){for(var v=0;v<6;v++)h+='<td class="w2ui-day-empty">&#160;</td>';g+=6}else if(g<u||f>l[e-1]){h+='<td class="w2ui-day-empty">&#160;</td>',g%7==0&&(h+="</tr><tr>");continue}var y=t+"/"+e+"/"+f,w=new Date(y),x="";6===w.getDay()&&(x=" w2ui-saturday"),0===w.getDay()&&(x=" w2ui-sunday"),y==s&&(x+=" w2ui-today");var b,k,D=f,T="",S="";if("datetime"===this.type?(b=w2utils.formatDateTime(y,d.format),k=w2utils.formatDate(y,w2utils.settings.dateFormat)):k=b=w2utils.formatDate(y,d.format),d.colored&&void 0!==d.colored[k]){var O=d.colored[k].split(":");S="background-color: "+O[0]+";",T="color: "+O[1]+";"}h+='<td class="'+(this.inRange(b,!0)?"w2ui-date "+(k==i?"w2ui-date-selected":""):"w2ui-blocked")+x+'"    style="'+T+S+'" date="'+b+'" data-date="'+w+'">'+D+"</td>",(g%7==0||0===u&&1==g)&&(h+="</tr><tr>"),f++}return h+="</tr></tbody></table>"},getYearHTML:function(){for(var e=w2utils.settings.shortmonths,t=w2utils.settings.dateStartYear,i=w2utils.settings.dateEndYear,n="",a="",l=0;l<e.length;l++)n+='<div class="w2ui-jump-month" name="'+l+'">'+e[l]+"</div>";for(var s=t;s<=i;s++)a+='<div class="w2ui-jump-year" name="'+s+'">'+s+"</div>";return'<div id="w2ui-jump-month">'+n+'</div><div id="w2ui-jump-year">'+a+"</div>"},getHourHTML:function(){var e=[],t=this.options;null==t&&(t={format:w2utils.settings.timeFormat});for(var i=t.format.indexOf("h24")>-1,n=0;n<24;n++){var a=(n>=12&&!i?n-12:n)+":00"+(i?"":n<12?" am":" pm");12!=n||i||(a="12:00 pm"),e[Math.floor(n/8)]||(e[Math.floor(n/8)]="");var l=this.fromMin(this.toMin(a)),s=this.fromMin(this.toMin(a)+59);if("datetime"===this.type){var o=w2utils.isDateTime(this.el.value,t.format,!0),r=t.format.split("|")[0].trim();l=w2utils.formatDate(o,r)+" "+l,s=w2utils.formatDate(o,r)+" "+s}e[Math.floor(n/8)]+='<div class="'+(this.inRange(l)||this.inRange(s)?"w2ui-time ":"w2ui-blocked")+'" hour="'+n+'">'+a+"</div>"}return'<div class="w2ui-calendar">   <div class="w2ui-calendar-title">'+w2utils.lang("Select Hour")+'</div>   <div class="w2ui-calendar-time"><table><tbody><tr>       <td>'+e[0]+"</td>       <td>"+e[1]+"</td>       <td>"+e[2]+"</td>   </tr></tbody></table></div></div>"},getMinHTML:function(e){null==e&&(e=0);var t=this.options;null==t&&(t={format:w2utils.settings.timeFormat});for(var i=t.format.indexOf("h24")>-1,n=[],a=0;a<60;a+=5){var l=(e>12&&!i?e-12:e)+":"+(a<10?0:"")+a+" "+(i?"":e<12?"am":"pm"),s=l,o=a<20?0:a<40?1:2;if(n[o]||(n[o]=""),"datetime"===this.type){var r=w2utils.isDateTime(this.el.value,t.format,!0),d=t.format.split("|")[0].trim();s=w2utils.formatDate(r,d)+" "+s}n[o]+='<div class="'+(this.inRange(s)?"w2ui-time ":"w2ui-blocked")+'" min="'+a+'">'+l+"</div>"}return'<div class="w2ui-calendar">   <div class="w2ui-calendar-title">'+w2utils.lang("Select Minute")+'</div>   <div class="w2ui-calendar-time"><table><tbody><tr>       <td>'+n[0]+"</td>       <td>"+n[1]+"</td>       <td>"+n[2]+"</td>   </tr></tbody></table></div></div>"},toMin:function(e){if("string"!=typeof e)return null;var t=e.split(":");return 2!==t.length?null:(t[0]=parseInt(t[0]),t[1]=parseInt(t[1]),-1!==e.indexOf("pm")&&12!==t[0]&&(t[0]+=12),60*t[0]+t[1])},fromMin:function(e){e>=1440&&(e%=1440),e<0&&(e=1440+e);var t=Math.floor(e/60),i=(e%60<10?"0":"")+e%60,n=this.options;return null==n&&(n={format:w2utils.settings.timeFormat}),-1!==n.format.indexOf("h24")?t+":"+i:(t<=12?t:t-12)+":"+i+" "+(t>=12?"pm":"am")}},e.extend(t.prototype,w2utils.event),w2obj.field=t}(jQuery);